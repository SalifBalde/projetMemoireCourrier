<form [formGroup]="form">
  <p-toast></p-toast>

  <div class="grid">
    <div class="col-12">
      <div class="card px-6 py-6">
        <div class="mb-5">
          <p-badge value="Liste des E-commerce à réceptionner" size="large" severity="primary" class="mr-3"></p-badge>
        </div>

        <!-- Table pour afficher la liste des e-commerce -->
        <p-table [value]="ecommerce" dataKey="code" [tableStyle]="{ 'min-width': '50rem' }" #dt>

          <ng-template pTemplate="header">
            <tr>
              <th>
                <p-tableHeaderCheckbox [table]="dt"></p-tableHeaderCheckbox>
              </th>
              <th>Numéro d'envoi</th>
              <th>Nom complet client</th>
              <th>Téléphone</th>
              <th>Destination</th>
              <th>Adresse Client</th>
              <th>Date</th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-ecommerce>
            <tr>
              <td>
                <!-- Ajout de la méthode onSelectColis -->
                <p-tableCheckbox [value]="ecommerce" (onChange)="onSelectColis(ecommerce)" />
              </td>
              <td>{{ ecommerce.numEnvoi }}</td>
              <td>{{ ecommerce.prenomClient }} {{ ecommerce.nomClient }}</td>
              <td>{{ ecommerce.telephoneClient }}</td>
              <td>{{ ecommerce.adresseClient }}</td>
              <td>{{ ecommerce.date | date: 'short' }}</td>
            </tr>
          </ng-template>
          
        </p-table>

        <!-- Bouton pour confirmer la réception -->
        <div class="col-12 flex flex-column lg:flex-row justify-content-end align-items-center">
          <!-- Bouton pour confirmer la réception -->
          <p-button 
          label="Réceptionner" 
          icon="pi pi-fw pi-download" 
          [disabled]="selectedColis.length === 0" 
          rounded 
          (click)="openColisDialog = true">
        </p-button>
        

        </div>
      </div>
    </div>
  </div>

</form>

<!-- Dialogue de confirmation -->
<p-dialog header="Confirmer" [(visible)]="openColisDialog" [modal]="true" [style]="{ width: '450px' }">
  <div class="flex align-items-center justify-content-center">
    <i class="pi pi-exclamation-triangle mr-3" style="font-size: 2rem"></i>
    <span>Etes-vous sûr que vous voulez réceptionner <b>{{ selectedColis.length }}</b> colis ?</span>
  </div>
  <ng-template pTemplate="footer">
    <button pButton pRipple icon="pi pi-check" class="p-button-text" label="Oui" (click)="confirmReception()">
    </button>
    <button pButton pRipple icon="pi pi-times" class="p-button-text p-button-danger" label="Non"
      (click)="closeConfirmDialog()">
    </button>
  </ng-template>
</p-dialog>