<div class="card p-fluid">
    <form [formGroup]="form">
        <div class="grid flex justify-content-center align-items-center">
            <div class="col-3 md:col-5">
                <label for="dateDebut">Du</label>
                <p-calendar formControlName="debut" id="dateDebut" [showIcon]="true" inputId="icon" />
            </div>
            <div class="col-3 md:col-5">
                <label for="dateFin">Au</label>
                <p-calendar formControlName="fin" id="dateFin" [showIcon]="true" inputId="icon" />
            </div>
            <div class="col-3 md:col-5">
                <p-dropdown optionLabel="libelle" [filter]="true" filterBy="libelle" optionValue="id"
                    ormControlName="paysOrigineId" optionValue="id" placeholder="Pays d'Origine"
                    [options]="pays$" [showClear]="true">
                </p-dropdown>
            </div>

            <div class="col-3 md:col-5">
                <p-dropdown optionLabel="libelle" [filter]="true" filterBy="libelle" optionValue="id"
                    formControlName="paysDestinationId" optionValue="id" placeholder="Pays Destination"
                    [options]="pays$" [showClear]="true">
                </p-dropdown>
            </div>
            <div class="col-3 md:col-5">
                <label htmlFor="au">Bureau:</label>
                <p-dropdown [options]="structure$" optionLabel="libelle"
                            formControlName="bureauDepotId"  optionValue="id"
                            placeholder="Select Bureau" [showClear]="true"></p-dropdown>
            </div>

            <div class="col-12 md:col-5">
                <p-dropdown formControlName="typeCourrierId" id="typeCourrierId" [filter]="true" filterBy="libelle" [showClear]="true" [options]="typeCourrier$"
                    placeholder="choisissez un Type" optionLabel="libelle" optionValue="id"></p-dropdown>
            </div>
            <div class="col-12 md:col-5">
                <p-dropdown formControlName="categorieId" id="categorieId" [filter]="true" filterBy="libelle" [showClear]="true" [options]="categorie$"
                    placeholder="choisissez un categorie" optionLabel="libelle" optionValue="id"></p-dropdown>
            </div>
            <div class="col-12 md:col-5">
                <p-dropdown formControlName="statutCourrierId" id="statutCourrierId" [filter]="true" filterBy="libelle" [showClear]="true" [options]="statutCourrier$"
                    placeholder="choisissez un status" optionLabel="libelle" optionValue="id"></p-dropdown>
            </div>
<!--            <div class="col-offset-6 md:col-4">-->
<!--                <p-dropdown formControlName="poids" id="poids" [filter]="true" filterBy="libelle" [showClear]="true"-->
<!--                            [options]="poid$" placeholder="choisissez un poid" optionLabel="libelle"-->
<!--                            optionValue="id"></p-dropdown>-->
<!--            </div>-->
            <div class="col-12 md:col-5">
                <label for="poidsMin">Poids Min :</label>
                <input pInputText type="number" formControlName="poidsMin" placeholder="Poids min en kg" />
            </div>

            <div class="col-12 md:col-5">
                <label for="poidsMax">Poids Max :</label>
                <input pInputText type="number" formControlName="poidsMax" placeholder="Poids max en kg" />
            </div>


        </div>

        <div class="col-6" style="display: flex; justify-content: center; gap: 40px; align-items: center;">

            <div style="display: flex; align-items: center;margin-left: 15%;">
                <p-dropdown formControlName="serviceId" id="serviceId" [filter]="true" filterBy="libelle" [showClear]="true" [options]="services$"
                            placeholder="choisissez un service" optionLabel="libelle" optionValue="id"></p-dropdown>
            </div>
            <div style="display: flex; align-items: center;">
                <label>
                    <input type="checkbox" [checked]="form.get('entrant')?.value === true" (change)="form.patchValue({ entrant: $event.target.checked ? true : null })" />
                    Import
                </label>
            </div>
            <label style="margin-left: 20px;">
                <input type="checkbox" [checked]="form.get('entrant')?.value === false" (change)="form.patchValue({ entrant: $event.target.checked ? false : null })" />
                Export
            </label>
            <div style="display: flex; align-items: center;">
                <label>
                    <input
                        type="radio"
                       [checked]="selectedRegime === 1"
                        (click)="toggleSelection(1)" />
                    National
                </label>
            </div>
            <label>
                <input
                    type="radio"
                    [checked]="selectedRegime === 2"   (click)="toggleSelection(2)" /> International
            </label>
        </div>




        <div class="p-formgrid flex col-6 col-offset-2 justify-content-center">
            <p-button
                class="mr-8"
                label="Rechercher"
                icon="pi pi-search"
                severity="primary"
                [loading]="loadingcourrier"
                [disabled]="form.invalid"
                (onClick)="searchcourrierByCriteres()"
            ></p-button>

            <p-button
                *ngIf="isEmpty()"
                label="effacer"
                icon="pi pi-times"
                severity="danger"
                [loading]="loadingReset"
                (onClick)="resetForm()"
            ></p-button>
        </div>

    </form>
</div>
<div class="grid">
    <div class="col-12">
        <div class="col-12">
            <div class="card px-4 py-4">
                <p-toast></p-toast>
                <p-toolbar styleClass="mb-4">
                    <ng-template pTemplate="left">
                        <div class="my-2">

                                <span class="text-900 font-medium text-lg font-bold justify-content-center">
                                    Date: {{ date | date: 'dd/MM/yyyy' }}
                                </span>

                            <ul class="list-none p-0 m-0 w-full">
                                <li class="mb-1">
                                    <span class="font-medium text-900">
                                        Bureau: {{ fullname?.libelle }}</span>
                                </li>

                                <li class="mb-1"><span class="font-medium text-900"> Rapport: du {{ form.get('debut')?.value | date: 'dd/MM/yyyy'}} au {{form.get('fin')?.value | date: 'dd/MM/yyyy' }}</span></li>
                                <li class="flex justify-content-between mb-1"><span class="text-900">Nombre:</span><span
                                    class="text-900 font-medium text-lg font-bold">{{courrier$?.length}}</span></li>
                                <li class="flex justify-content-between mb-1"><span class="text-900">Total: </span><span
                                    class="text-900 font-medium text-lg font-bold">{{montant|customCurrency}}</span></li>
                            </ul>
                        </div>
                    </ng-template>
                    <ng-template pTemplate="right">
                        <button pButton type="button" icon="pi pi-file-pdf" class="p-button-warning mr-2"
                            (click)="generatePdf()" [disabled]="loadingcourrier"> PDF</button>
                        <button pButton type="button" icon="pi pi-file-excel" (click)="generateExcel()"
                            [disabled]="loadingcourrier">Excel</button>
                    </ng-template>
                </p-toolbar>
                <p-table #dt [value]="courrier$" styleClass="p-datatable-gridlines"
                    [tableStyle]="{ 'min-width': '50rem' }" [paginator]="true" [rows]=20
                    [globalFilterFields]="['code','prenomDestinataire','nomDestinataire','montant','createdAt']">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>Code</th>
                            <th>Expéditeur</th>
                            <th>Pays d'Origine</th>
                            <th>Pays Destination</th>
                            <th>Type Courrier</th>
                            <th>Poids</th>
                            <th>Catégorie</th>
                            <th>Statut Courrier</th>
                            <th>Montant</th>
                            <th>Date</th>
                            <th></th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-courrier>
                        <tr>
                            <td>{{ courrier.codeBarre }}</td>
                            <td>{{ courrier. expediteurPrenom }} {{courrier.expediteurNom}}</td>
                            <td>{{ courrier. paysOrigineLibelle}}</td>
                            <td>{{ courrier.paysDestinationLibelle}}</td>
                            <td>{{courrier.typeCourrierLibelle}}</td>
                            <td>{{courrier.poids}}</td>
                            <td>{{courrier.categorieLibelle}}</td>
                            <td>{{courrier.statutCourrierLibelle}}</td>
                            <td>{{ courrier.montant }}</td>
                            <td>{{ courrier.createdAt }}</td>
                            <td>
                                <a [routerLink]="['/receveur/courrier-details/', courrier.id]" pButton="" type="button"
                                    icon="pi pi-download" class="p-element p-button-text p-button p-component p-button-icon-only"><span class="p-button-icon pi pi-download" aria-hidden="true"></span></a>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
        </div>
    </div>
</div>
