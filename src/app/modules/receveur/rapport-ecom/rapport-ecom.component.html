<div class="card p-fluid">
  <form [formGroup]="form">
    <div class="grid flex justify-content-center align-items-center">
      <div class="col-3 md:col-5">
        <p-dropdown optionLabel="libelle" [filter]="true" filterBy="libelle" optionValue="id"
          formControlName="IdbureauPartenaire" placeholder="Bureau de dépôt" [options]="structure$"
          [showClear]="true">
        </p-dropdown>
      </div>

      <div class="col-3 md:col-5">
        <p-dropdown optionLabel="libelle" [filter]="true" filterBy="libelle" optionValue="id"
          formControlName="idbureau" placeholder="Bureau Destinataire" [options]="structure$"
          [showClear]="true">
        </p-dropdown>
      </div>

      <div class="col-3 md:col-5">
        <p-dropdown formControlName="partenaire_e_com_id" [filter]="true" filterBy="libelle"
          [options]="partenaire$" placeholder="Choisissez un partenaire" optionLabel="libelle"
          optionValue="id">
        </p-dropdown>
      </div>

      <div class="col-3 md:col-5">
        <p-dropdown formControlName="etatEcomId" [filter]="true" filterBy="libelle" [options]="status$"
          placeholder="Choisissez un statut" optionLabel="libelle" optionValue="id">
        </p-dropdown>
      </div>
    </div>

    <div class="p-formgrid flex col-6 col-offset-3 justify-content-center mr-2">
      <p-button label="Rechercher" icon="pi pi-search" severity="primary" [loading]="loading"
        (onClick)="searchExpeditionByCriteres()" class="mr-2">
      </p-button>

      <p-button *ngIf="isEmpty()" label="Effacer" icon="pi pi-times" severity="danger" [loading]="loadingReset"
        (onClick)="resetForm()">
      </p-button>
    </div>
  </form>
</div>

<div class="grid">
  <div class="col-12">
    <div class="col-12">
      <div class="card px-4 py-4">
        <p-toast></p-toast>

        <p-toolbar styleClass="mb-4">
          <ng-template pTemplate="left">
            <div class="my-2">
              <ul class="list-none p-0 m-0 w-full">
                <li class="mb-1">
                  <span class="font-medium text-900">Bureau: {{ fullname }}</span>
                </li>
                <li class="flex justify-content-between mb-1">
                  <span class="text-900">Responsable:</span>
                  <span class="text-900 font-medium text-lg font-bold">{{ ecommerce?.length }}</span>
                </li>
                <li class="flex justify-content-between mb-1">
                  <span class="text-900">Période:</span>
                  <span class="text-900 font-medium text-lg font-bold">{{ date | date:'dd/MM/yyyy' }}</span>
                </li>
              </ul>
            </div>
          </ng-template>

          <ng-template pTemplate="right">
            <button pButton type="button" icon="pi pi-file-pdf" class="p-button-warning mr-2" (click)="generatePdf()" [disabled]="loading"></button>
            <button pButton type="button" icon="pi pi-file-excel" (click)="dt.exportCSV()" [disabled]="loading"></button>
          </ng-template>
        </p-toolbar>

        <p-table #dt [value]="ecommerce$" styleClass="p-datatable-gridlines" [tableStyle]="{ 'min-width': '50rem' }"
          [paginator]="true" [rows]="5"
          [globalFilterFields]="['code', 'prenomDestinataire', 'nomDestinataire', 'montant', 'createdAt']">
          <ng-template pTemplate="header">
            <tr>
              <th>Numero</th>
              <th>Bureau Dépôt</th>
              <th>Bureau Destination</th>
              <th>Partenaire</th>
              <th>Nom Client</th>
              <th>Statut</th>
              <th>Actions</th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-ecommerce>
            <tr>
              <td>{{ ecommerce.numenvoi }}</td>
              <td>{{ ecommerce.partenaireBureauLibelle }}</td>
              <td>{{ ecommerce.bureauDestinationLibelle }}</td>
              <td>{{ ecommerce.partenaireLibelle }}</td>
              <td>{{ ecommerce.prenomClient }} {{ ecommerce.nomClient }}</td>
              <td>{{ ecommerce.etatEcomLibelle }}</td>
              <td>
                <a [routerLink]="['/receveur/ecom-details/', ecommerce.id]" pButton="" type="button"
                  icon="pi pi-eye" class="p-element p-button-text p-button p-component p-button-icon-only">
                  <span class="p-button-icon pi pi-eye" aria-hidden="true"></span>
                </a>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>
  </div>
</div>
